# LongTextAgent ğŸ“š

åŸºäº **AgentWrite** æ€è·¯çš„é•¿æ–‡æœ¬ç”Ÿæˆ Agentï¼Œæ”¯æŒå¤šç§æ–‡æ¡£ç±»å‹ï¼Œå…·å¤‡è®°å¿†ç®¡ç†å’Œä¸€è‡´æ€§æ£€æŸ¥èƒ½åŠ›ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¯ **å¤šæ¨¡å¼æ”¯æŒ** - å°è¯´ã€ç ”ç©¶æŠ¥å‘Šã€åšå®¢æ–‡ç« ã€æŠ€æœ¯æ–‡æ¡£
- ğŸ§  **æ™ºèƒ½è®°å¿†** - å±‚çº§æ‘˜è¦ç®¡ç†ï¼Œçªç ´ä¸Šä¸‹æ–‡é™åˆ¶
- ğŸ” **ä¸€è‡´æ€§æ£€æŸ¥** - äººç‰©/è®¾å®š/è¿ç»­æ€§åˆ†ç±»è‡ªåŠ¨æ£€æŸ¥
- ğŸ¤– **å¤šæ¨¡å‹æ”¯æŒ** - åŸç”Ÿæ”¯æŒ DeepSeek, OpenAI, Claude, é€šä¹‰åƒé—®, æ™ºè°±GLM, Moonshot ç­‰
- ğŸ“ **ä»»åŠ¡åˆ†è§£** - è‡ªåŠ¨å°†é•¿æ–‡æ‹†åˆ†ä¸º 2000-3000 å­—çš„å­ä»»åŠ¡
- ğŸ”§ **çµæ´»é…ç½®** - YAML é…ç½®ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡å¼

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip install openai pyyaml tiktoken rich
```

### è®¾ç½® API Key

```bash
# Linux/Mac
export DEEPSEEK_API_KEY="sk-your-key"

# Windows PowerShell
$env:DEEPSEEK_API_KEY="sk-your-key"
```

### è¿è¡Œç”Ÿæˆ

```bash
# ç”Ÿæˆå°è¯´ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰
python main.py --mode novel --outline examples/sample_outline.yaml --title "æˆ‘çš„å°è¯´" -w 10000

# ç”Ÿæˆç ”ç©¶æŠ¥å‘Š
python main.py --mode report --outline examples/report_outline.yaml --title "è¡Œä¸šæŠ¥å‘Š" -w 8000

# ç”Ÿæˆåšå®¢æ–‡ç« 
python main.py --mode article --outline examples/article_outline.yaml --title "æŠ€æœ¯æ–‡ç« " -w 5000

# æŸ¥çœ‹æ‰€æœ‰æ¨¡å¼
python main.py --list-modes
### è‡ªæˆ‘çŸ«æ­£ (Self-Correction)

```bash
# ç”Ÿæˆåè‡ªåŠ¨è¿›è¡Œæ£€æŸ¥
python main.py --outline outline.yaml --auto-check

# æ£€æŸ¥å·²æœ‰æ–‡ä»¶
python main.py --check-file output/novel.md
```

## ğŸ“‹ æ”¯æŒçš„æ¨¡å¼

| æ¨¡å¼       | å‘½ä»¤               | é€‚ç”¨åœºæ™¯                       |
|------------|--------------------|--------------------------------|
| ğŸ“š novel   | `--mode novel`     | å°è¯´ã€æ•…äº‹ã€å‰§æœ¬               |
| ğŸ“Š report  | `--mode report`    | ç ”ç©¶æŠ¥å‘Šã€è¡Œä¸šåˆ†æã€å¸‚åœºè°ƒç ”   |
| ğŸ“ article | `--mode article`   | å…¬ä¼—å·ã€åšå®¢ã€ä¸“æ æ–‡ç«          |
| ğŸ“‹ document| `--mode document`  | APIæ–‡æ¡£ã€ç”¨æˆ·æŒ‡å—ã€äº§å“æ‰‹å†Œ    |
| ğŸ”§ custom  | `--mode custom`    | è‡ªå®šä¹‰é…ç½®                     |

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·è¾“å…¥                              â”‚
â”‚              å¤§çº² + è®¾å®š + ç›®æ ‡å­—æ•° + æ¨¡å¼                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ“‹ é˜¶æ®µä¸€: è§„åˆ’ (Planner)                  â”‚
â”‚         è§£æå¤§çº² â†’ è¯†åˆ«ç« èŠ‚ â†’ åˆ†è§£å­ä»»åŠ¡ â†’ åˆ†é…å­—æ•°           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   âœï¸ é˜¶æ®µäºŒ: ç”Ÿæˆ (Writer)                   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ æ„å»ºä¸Šä¸‹æ–‡ â”‚ â†’ â”‚ è°ƒç”¨ LLM â”‚ â†’ â”‚ è®°å½•æ‘˜è¦åˆ° Memory â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â†‘                                    â”‚                 â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¾ªç¯ç›´åˆ°å®Œæˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ğŸ” é˜¶æ®µä¸‰: ä¸€è‡´æ€§æ£€æŸ¥ (Checker)               â”‚
â”‚      äººç‰©åç§° â†’ è¡Œä¸ºä¸€è‡´æ€§ â†’ è¿ç»­æ€§ â†’ è®¾å®šå†²çª â†’ æŠ¥å‘Š         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸ“„ é˜¶æ®µå››: è¾“å‡º                          â”‚
â”‚              åˆå¹¶ç« èŠ‚ â†’ ä¿å­˜æ–‡ä»¶ â†’ ç”Ÿæˆæ£€æŸ¥æŠ¥å‘Š               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„

```text
LongTextAgent/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ settings.yaml      # åŸºç¡€é…ç½® (LLMã€ç”Ÿæˆå‚æ•°)
â”‚   â””â”€â”€ modes.yaml         # 5ç§æ¨¡å¼çš„æç¤ºè¯é…ç½®
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ planner.py         # å¤§çº²è§£æã€ä»»åŠ¡åˆ†è§£
â”‚   â”œâ”€â”€ writer.py          # å¤šæ¨¡å¼å†…å®¹ç”Ÿæˆ
â”‚   â””â”€â”€ checker.py         # ä¸€è‡´æ€§æ£€æŸ¥å™¨
â”œâ”€â”€ memory/
â”‚   â”œâ”€â”€ context_manager.py # åŸºç¡€ä¸Šä¸‹æ–‡ç®¡ç†
â”‚   â”œâ”€â”€ summary_store.py   # å±‚çº§æ‘˜è¦ (æ®µè½â†’ç« èŠ‚â†’å·)
â”‚   â””â”€â”€ settings_store.py  # äººç‰©æ¡£æ¡ˆã€ä¼ç¬”ã€æ—¶é—´çº¿
â”œâ”€â”€ pipeline/
â”‚   â””â”€â”€ novel_pipeline.py  # ä¸»ç”Ÿæˆç®¡é“
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ llm_client.py      # LLM å®¢æˆ·ç«¯ (DeepSeek)
â”‚   â””â”€â”€ text_utils.py      # æ–‡æœ¬å¤„ç†å·¥å…·
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ sample_outline.yaml   # å°è¯´å¤§çº²ç¤ºä¾‹
â”‚   â”œâ”€â”€ report_outline.yaml   # æŠ¥å‘Šå¤§çº²ç¤ºä¾‹
â”‚   â””â”€â”€ article_outline.yaml  # æ–‡ç« å¤§çº²ç¤ºä¾‹
â”œâ”€â”€ main.py                # å‘½ä»¤è¡Œå…¥å£
â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md              # æœ¬æ–‡æ¡£
```

## ğŸ“ å¤§çº²æ ¼å¼

### YAML æ ¼å¼ï¼ˆæ¨èï¼‰

```yaml
title: æˆ‘çš„å°è¯´

settings:
  world: |
    ç°ä»£éƒ½å¸‚èƒŒæ™¯ï¼Œçµæ°”å¤è‹çš„ä¸–ç•Œ
  characters:
    æ—æ™“: ä¸»è§’ï¼Œç¨‹åºå‘˜ï¼Œæ„å¤–è§‰é†’å¼‚èƒ½
    è‹ç„¶: ç¥ç§˜ç»„ç»‡æˆå‘˜ï¼Œè´Ÿè´£æ‹›å‹Ÿè§‰é†’è€…

chapters:
  - title: ç¬¬ä¸€ç«  è§‰é†’
    brief: ä¸»è§’åœ¨åŠ ç­æ—¶æ„å¤–è§‰é†’å¼‚èƒ½
    words: 3000
  
  - title: ç¬¬äºŒç«  æ¥è§¦
    brief: ç¥ç§˜ç»„ç»‡æ‰¾ä¸Šé—¨æ¥
    words: 3000
```

### çº¯æ–‡æœ¬æ ¼å¼

```text
ç¬¬ä¸€ç« ï¼šä¸»è§’è§‰é†’å¼‚èƒ½
ç¬¬äºŒç« ï¼šç¥ç§˜ç»„ç»‡æ¥è§¦
ç¬¬ä¸‰ç« ï¼šç¬¬ä¸€æ¬¡æˆ˜æ–—
```

## âš™ï¸ å‘½ä»¤è¡Œå‚æ•°

| å‚æ•°                 | è¯´æ˜               | é»˜è®¤å€¼                   |
|----------------------|--------------------|--------------------------|
| `--outline, -o`      | å¤§çº²æ–‡ä»¶è·¯å¾„       | (å¿…å¡«)                   |
| `--mode, -m`         | ç”Ÿæˆæ¨¡å¼           | `novel`                  |
| `--target-words, -w` | ç›®æ ‡å­—æ•°           | `10000`                  |
| `--title, -t`        | ä½œå“æ ‡é¢˜           | `æœªå‘½åä½œå“`             |
| `--config, -c`       | é…ç½®æ–‡ä»¶           | `config/settings.yaml`   |
| `--no-check`         | ç¦ç”¨ä¸€è‡´æ€§æ£€æŸ¥     | `False`                  |
| `--list-modes`       | æ˜¾ç¤ºæ‰€æœ‰æ¨¡å¼       | -                        |

## ğŸ§  æ ¸å¿ƒç®—æ³•

### AgentWrite æ€è·¯

1. **ä»»åŠ¡åˆ†è§£** - å°†é•¿æ–‡æœ¬ç›®æ ‡æ‹†åˆ†ä¸ºå¤šä¸ª 2000-3000 å­—çš„å­ä»»åŠ¡
2. **é€æ®µç”Ÿæˆ** - ä¸ºæ¯ä¸ªå­ä»»åŠ¡æ„å»ºä¸Šä¸‹æ–‡å¹¶è°ƒç”¨ LLM ç”Ÿæˆ
3. **æ‘˜è¦å‹ç¼©** - å°†å·²ç”Ÿæˆå†…å®¹å‹ç¼©ä¸ºæ‘˜è¦ï¼Œä¿æŒä¸Šä¸‹æ–‡çª—å£å¯æ§
4. **æ‹¼æ¥è¾“å‡º** - åˆå¹¶æ‰€æœ‰ç”Ÿæˆå†…å®¹

### ä¸Šä¸‹æ–‡æ„å»º

```text
ä¸Šä¸‹æ–‡ = ä¸–ç•Œè§‚è®¾å®š (å›ºå®š)
       + æœ€è¿‘5æ¡ç« èŠ‚æ‘˜è¦ (æ»šåŠ¨æ›´æ–°)
       + å‰æ–‡500å­— (è¡”æ¥å‚è€ƒ)
       + å½“å‰ä»»åŠ¡æè¿° (åŠ¨æ€)
```

## ğŸ” ä¸€è‡´æ€§æ£€æŸ¥

ç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

| æ£€æŸ¥é¡¹       | è¯´æ˜                           |
|--------------|--------------------------------|
| äººç‰©åç§°     | æ£€æµ‹åç§°å˜ä½“/ç¬”è¯¯              |
| è¡Œä¸ºä¸€è‡´æ€§   | äººç‰©è¡Œä¸ºæ˜¯å¦ç¬¦åˆè®¾å®šæ€§æ ¼       |
| è¿ç»­æ€§       | åœºæ™¯è¿‡æ¸¡ã€çŠ¶æ€è¡”æ¥æ˜¯å¦è‡ªç„¶     |
| è®¾å®šå†²çª     | å†…å®¹æ˜¯å¦ä¸ä¸–ç•Œè§‚çŸ›ç›¾           |
| é€»è¾‘æ¼æ´     | LLM æ·±åº¦æ£€æŸ¥å‰åçŸ›ç›¾           |

å‘ç°é—®é¢˜æ—¶è‡ªåŠ¨ç”Ÿæˆæ£€æŸ¥æŠ¥å‘Šã€‚

## ğŸ”§ é…ç½®è¯´æ˜

### config/settings.yaml

```yaml
# åˆ›ä½œä¸è¯„ä¼°è§£è€¦çš„åŒæ¨¡å‹æ¶æ„
generator_llm:
  provider: deepseek
  api_key: "sk-your-key"  # æˆ–ä½¿ç”¨å¯¹åº”ç¯å¢ƒå˜é‡
  model: deepseek-chat
  temperature: 0.7

evaluator_llm:
  provider: deepseek
  api_key: "sk-your-key"
  model: deepseek-chat
  temperature: 0.7

generation:
  words_per_section: 2500  # æ¯ä¸ªå­ä»»åŠ¡çš„ç›®æ ‡å­—æ•°
  min_words_tolerance: 0.8 # æœ€å°å­—æ•°å®¹å·®
  max_words_tolerance: 1.2 # æœ€å¤§å­—æ•°å®¹å·®
  summary_max_words: 300

context:
  recent_summaries_count: 5
  max_context_tokens: 8000

consistency:
  enabled: true
  check_character_names: true
  check_timeline: true
  check_settings: true

evaluation:
  target_pass_score: 81
  max_retries: 3

output:
  directory: ./output
  filename_format: "{title}_{timestamp}.md"
```

## ğŸ“Š æ€§èƒ½å‚è€ƒ

| ç›®æ ‡å­—æ•° | ç« èŠ‚æ•° | é¢„è®¡è€—æ—¶     | API è°ƒç”¨æ¬¡æ•° |
|----------|--------|--------------|--------------|
| 5,000    | 2-3    | 3-5 åˆ†é’Ÿ     | ~10          |
| 10,000   | 4-5    | 8-12 åˆ†é’Ÿ    | ~20          |
| 30,000   | 10-15  | 30-45 åˆ†é’Ÿ   | ~60          |

*å®é™…è€—æ—¶å–å†³äºç½‘ç»œå’Œ API å“åº”é€Ÿåº¦*

## ğŸ› ï¸ å¼€å‘è®¡åˆ’

- [ ] æ·»åŠ  Web UI ç•Œé¢
- [ ] æ”¯æŒæ–­ç‚¹ç»­å†™
- [ ] æ·»åŠ  RAG æ£€ç´¢å¢å¼º
- [ ] å¤š Agent åä½œæ¨¡å¼

## ğŸ“„ License

MIT License

## ğŸ™ è‡´è°¢

- çµæ„Ÿæ¥æºï¼š[AgentWrite](https://arxiv.org/abs/2407.21500) è®ºæ–‡
- LLM æä¾›ï¼š[DeepSeek](https://www.deepseek.com/)
